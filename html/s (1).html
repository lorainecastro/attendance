<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enhanced Attendance System Flowchart</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.9.1/dist/mermaid.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .glass-effect {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .mermaid-container {
            max-width: 100%;
            overflow: auto;
            padding: 2rem;
            border-radius: 1rem;
            background: rgba(255, 255, 255, 0.95);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            position: relative;
        }
        .mermaid-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #3b82f6, #10b981, #f59e0b, #ef4444);
            border-radius: 1rem 1rem 0 0;
        }
        .nav-btn {
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        .nav-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }
        .nav-btn:hover::before {
            left: 100%;
        }
        .nav-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }
        .nav-btn.active {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            transform: scale(1.05);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
        }
        .zoom-controls {
            position: absolute;
            top: 1rem;
            right: 1rem;
            display: flex;
            gap: 0.5rem;
            z-index: 10;
        }
        .zoom-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.9);
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        .zoom-btn:hover {
            background: white;
            transform: scale(1.1);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }
        .search-box {
            position: relative;
            margin-bottom: 1rem;
        }
        .search-input {
            width: 100%;
            padding: 0.75rem 1rem 0.75rem 2.5rem;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 0.75rem;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }
        .search-input:focus {
            outline: none;
            border-color: #3b82f6;
            background: rgba(255, 255, 255, 0.2);
        }
        .search-input::placeholder {
            color: rgba(255, 255, 255, 0.7);
        }
        .search-icon {
            position: absolute;
            left: 0.75rem;
            top: 50%;
            transform: translateY(-50%);
            color: rgba(255, 255, 255, 0.7);
        }
        .legend-card {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05));
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 0.75rem;
            padding: 1rem;
            margin-top: 1rem;
        }
        .legend-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
        }
        .legend-color {
            width: 16px;
            height: 16px;
            border-radius: 4px;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }
        .floating-info {
            position: fixed;
            top: 50%;
            right: 2rem;
            transform: translateY(-50%);
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border-radius: 0.75rem;
            padding: 1rem;
            max-width: 250px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            z-index: 20;
            transition: all 0.3s ease;
            opacity: 0;
            pointer-events: none;
        }
        .floating-info.visible {
            opacity: 1;
            pointer-events: all;
        }
        .progress-bar {
            height: 4px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 2px;
            overflow: hidden;
            margin-top: 1rem;
        }
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #3b82f6, #10b981);
            border-radius: 2px;
            transition: width 0.3s ease;
        }
    </style>
</head>
<body>
    <div class="min-h-screen p-4">
        <!-- Header -->
        <header class="glass-effect rounded-xl p-6 mb-6">
            <div class="text-center">
                <h1 class="text-3xl font-bold text-white mb-2">San Rafael National Trade School</h1>
                <p class="text-white/80">Interactive Attendance Monitoring System Flow</p>
                <div class="progress-bar">
                    <div class="progress-fill" id="progress-fill" style="width: 0%"></div>
                </div>
            </div>
        </header>

        <!-- Search and Navigation -->
        <div class="glass-effect rounded-xl p-6 mb-6">
            <div class="search-box">
                <input 
                    type="text" 
                    class="search-input" 
                    placeholder="Search flowchart sections..."
                    id="searchInput"
                    oninput="searchSections()"
                >
                <div class="search-icon">üîç</div>
            </div>
            
            <div class="flex flex-wrap gap-3">
                <button onclick="highlightSection('auth')" class="nav-btn bg-blue-500/80 text-white px-4 py-2 rounded-lg font-medium" data-section="auth">
                    üîê Authentication
                </button>
                <button onclick="highlightSection('dashboard')" class="nav-btn bg-green-500/80 text-white px-4 py-2 rounded-lg font-medium" data-section="dashboard">
                    üìä Dashboard
                </button>
                <button onclick="highlightSection('class')" class="nav-btn bg-green-500/80 text-white px-4 py-2 rounded-lg font-medium" data-section="class">
                    üìö Classes
                </button>
                <button onclick="highlightSection('student')" class="nav-btn bg-green-500/80 text-white px-4 py-2 rounded-lg font-medium" data-section="student">
                    üë• Students
                </button>
                <button onclick="highlightSection('attendance')" class="nav-btn bg-green-500/80 text-white px-4 py-2 rounded-lg font-medium" data-section="attendance">
                    ‚úÖ Attendance
                </button>
                <button onclick="highlightSection('analytics')" class="nav-btn bg-orange-500/80 text-white px-4 py-2 rounded-lg font-medium" data-section="analytics">
                    üìà Analytics
                </button>
                <button onclick="highlightSection('recommend')" class="nav-btn bg-orange-500/80 text-white px-4 py-2 rounded-lg font-medium" data-section="recommend">
                    üí° Recommendations
                </button>
                <button onclick="highlightSection('report')" class="nav-btn bg-orange-500/80 text-white px-4 py-2 rounded-lg font-medium" data-section="report">
                    üìã Reports
                </button>
                <button onclick="resetView()" class="nav-btn bg-gray-500/80 text-white px-4 py-2 rounded-lg font-medium">
                    üîÑ Reset View
                </button>
            </div>
        </div>

        <!-- Main Flowchart -->
        <div class="glass-effect rounded-xl p-6">
            <div class="mermaid-container" id="mermaid-container">
                <!-- Zoom Controls -->
                <div class="zoom-controls">
                    <button class="zoom-btn" onclick="zoomIn()" title="Zoom In">+</button>
                    <button class="zoom-btn" onclick="zoomOut()" title="Zoom Out">-</button>
                    <button class="zoom-btn" onclick="resetZoom()" title="Reset Zoom">‚åÇ</button>
                </div>

                <div id="mermaid-flowchart" class="mermaid">
                    graph TD
                        subgraph " üîê Authentication Flow "
                            A[üöÄ System Start] --> B[üìù Sign-Up Page]
                            B -->|‚úÖ Register| C[üîë Sign-In Page]
                            C -->|üéØ Login Success| D[üìä Teacher Dashboard]
                            C -->|‚ùå Login Failed| C
                            C -->|üö™ Logout| L[‚öôÔ∏è Settings/Logout]
                            L --> C
                        end

                        subgraph " üìä Main Dashboard "
                            D -->|üìö Manage Classes| E[üìñ Class Management]
                            D -->|üë• Manage Students| F[üë§ Student Management]
                            D -->|‚úÖ Mark Attendance| G[üìã Attendance Tracking]
                            D -->|üìà View Analytics| H[üìä Analytics Dashboard]
                            D -->|üí° View Recommendations| J[üéØ Recommendation Hub]
                            D -->|üìã Generate Reports| K[üìÑ Report Generation]
                        end

                        subgraph " üìö Class Management "
                            E -->|üëÄ View Classes| E1[üìã Class List]
                            E -->|‚ûï Add New Class| E2[üìù Create Class Form]
                            E -->|‚úèÔ∏è Edit Class| E3[üõ†Ô∏è Edit Class Form]
                            E1 --> D
                            E2 --> E1
                            E3 --> E1
                        end

                        subgraph " üë• Student Management "
                            F -->|üëÄ View Students| F1[üìã Student List]
                            F -->|‚ûï Add Student| F2[üìù Add Student Form]
                            F -->|‚úèÔ∏è Edit Student| F3[üõ†Ô∏è Edit Student Form]
                            F1 -->|üîç View Details| I[üë§ Student Dashboard]
                            F2 --> F1
                            F3 --> F1
                            F1 --> D
                        end

                        subgraph " ‚úÖ Attendance Tracking "
                            G -->|üìä Mark Present/Absent| G1[‚úÖ Attendance Grid]
                            G -->|üìÖ Select Date| G2[üìÜ Date Picker]
                            G -->|üíæ Save Attendance| G3[üíæ Save Records]
                            G1 --> G3
                            G2 --> G1
                            G3 --> D
                        end

                        subgraph " üìà Analytics & Insights "
                            H -->|üìä View Trends| H1[üìà Charts & Statistics]
                            H -->|üìÖ Filter by Date| H2[üóìÔ∏è Date Range Filter]
                            H -->|üë• Filter by Class| H3[üéØ Class Filter]
                            H1 --> D
                            H2 --> H1
                            H3 --> H1
                        end

                        subgraph " üí° Smart Recommendations "
                            J -->|üéØ View Suggestions| J1[üìù Recommendation List]
                            J -->|‚ö†Ô∏è At-Risk Students| J2[üö® Alert System]
                            J1 -->|üë§ View Student| I
                            J2 --> I
                            J1 --> D
                        end

                        subgraph " üë§ Student Profile "
                            I -->|üìä View Summary| I1[üìã Student Summary]
                            I -->|üìà View Progress| I2[üìä Progress Charts]
                            I -->|üìû Contact Info| I3[üìû Contact Details]
                            I1 -->|‚¨ÖÔ∏è Back to List| F
                            I2 --> I1
                            I3 --> I1
                            I --> D
                        end

                        subgraph " üìã Report Generation "
                            K -->|üìÑ Select Report Type| K1[üìã Report Templates]
                            K -->|üëÄ Preview Report| K2[üëÅÔ∏è Report Preview]
                            K -->|üì§ Export Report| K3[üì§ Export Options]
                            K1 --> K2
                            K2 --> K3
                            K3 --> D
                        end

                        %% Enhanced Styling
                        classDef authStyle fill:#dbeafe,stroke:#3b82f6,stroke-width:3px,color:#1e40af
                        classDef dashboardStyle fill:#d1fae5,stroke:#10b981,stroke-width:3px,color:#065f46
                        classDef analyticsStyle fill:#fef3c7,stroke:#f59e0b,stroke-width:3px,color:#92400e
                        classDef actionStyle fill:#fce7f3,stroke:#ec4899,stroke-width:2px,color:#be185d
                        classDef startStyle fill:#dcfce7,stroke:#16a34a,stroke-width:4px,color:#15803d

                        class A startStyle
                        class B,C,L authStyle
                        class D dashboardStyle
                        class E,F,G,E1,E2,E3,F1,F2,F3,G1,G2,G3 dashboardStyle
                        class H,J,I,K,H1,H2,H3,J1,J2,I1,I2,I3,K1,K2,K3 analyticsStyle
                </div>
            </div>

            <!-- Enhanced Legend -->
            <div class="legend-card">
                <h3 class="text-white font-semibold mb-3">üìã Interactive Legend</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-2">
                    <div class="legend-item">
                        <div class="legend-color" style="background: #dbeafe;"></div>
                        <span class="text-white text-sm">üîê Authentication & Security</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: #d1fae5;"></div>
                        <span class="text-white text-sm">üìä Core Dashboard Functions</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: #fef3c7;"></div>
                        <span class="text-white text-sm">üìà Analytics & Reporting</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: #dcfce7;"></div>
                        <span class="text-white text-sm">üöÄ System Entry Points</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Floating Info Panel -->
    <div class="floating-info" id="floatingInfo">
        <h4 class="font-semibold text-gray-800 mb-2">Section Details</h4>
        <p class="text-sm text-gray-600" id="sectionDetails">Click on any section to view detailed information about its functionality.</p>
    </div>

    <script>
        let currentZoom = 1;
        let currentSection = null;
        const sections = {
            auth: {
                title: "üîê Authentication System",
                description: "Secure login and registration system with session management and logout functionality."
            },
            dashboard: {
                title: "üìä Main Dashboard",
                description: "Central hub for accessing all system features including class management, student records, and attendance tracking."
            },
            class: {
                title: "üìö Class Management",
                description: "Comprehensive class administration including creation, editing, and organization of academic classes."
            },
            student: {
                title: "üë• Student Management",
                description: "Complete student information system with profile management and academic tracking capabilities."
            },
            attendance: {
                title: "‚úÖ Attendance Tracking",
                description: "Real-time attendance marking with date selection and record management functionality."
            },
            analytics: {
                title: "üìà Analytics Dashboard",
                description: "Data visualization and trend analysis with customizable filters and statistical insights."
            },
            recommend: {
                title: "üí° Smart Recommendations",
                description: "AI-powered recommendations for student intervention and academic support strategies."
            },
            report: {
                title: "üìã Report Generation",
                description: "Comprehensive reporting system with multiple export formats and customizable templates."
            }
        };

        // Initialize Mermaid with enhanced styling
        mermaid.initialize({
            startOnLoad: true,
            theme: 'base',
            flowchart: { 
                curve: 'basis',
                nodeSpacing: 50,
                rankSpacing: 60,
                padding: 20
            },
            themeVariables: {
                primaryColor: '#3b82f6',
                secondaryColor: '#10b981',
                tertiaryColor: '#f59e0b',
                primaryTextColor: '#1f2937',
                primaryBorderColor: '#374151',
                lineColor: '#6b7280',
                fontSize: '14px',
                fontFamily: 'Inter, sans-serif'
            }
        });

        // Enhanced section highlighting
        function highlightSection(section) {
            resetView();
            currentSection = section;
            
            // Update navigation buttons
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`[data-section="${section}"]`).classList.add('active');
            
            // Show section details
            showSectionDetails(section);
            
            // Update progress bar
            updateProgress(section);
            
            // Smooth scroll to flowchart
            document.getElementById('mermaid-container').scrollIntoView({ 
                behavior: 'smooth', 
                block: 'center' 
            });
            
            // Highlight animation
            setTimeout(() => {
                const mermaidSvg = document.querySelector('#mermaid-flowchart svg');
                if (mermaidSvg) {
                    const nodes = mermaidSvg.querySelectorAll('g.node');
                    nodes.forEach(node => {
                        const text = node.textContent.toLowerCase();
                        if (text.includes(section) || isRelatedNode(text, section)) {
                            node.style.filter = 'drop-shadow(0 0 10px #3b82f6)';
                            node.style.transform = 'scale(1.05)';
                            node.style.transition = 'all 0.3s ease';
                        }
                    });
                }
            }, 500);
        }

        function isRelatedNode(text, section) {
            const relations = {
                'auth': ['sign', 'login', 'register', 'logout'],
                'dashboard': ['dashboard', 'teacher'],
                'class': ['class', 'management'],
                'student': ['student', 'profile'],
                'attendance': ['attendance', 'mark', 'present'],
                'analytics': ['analytics', 'chart', 'trend'],
                'recommend': ['recommend', 'suggestion', 'alert'],
                'report': ['report', 'export', 'template']
            };
            
            return relations[section]?.some(keyword => text.includes(keyword)) || false;
        }

        function showSectionDetails(section) {
            const info = sections[section];
            const floatingInfo = document.getElementById('floatingInfo');
            const sectionDetails = document.getElementById('sectionDetails');
            
            if (info) {
                sectionDetails.innerHTML = `
                    <strong>${info.title}</strong><br>
                    <span class="text-xs">${info.description}</span>
                `;
                floatingInfo.classList.add('visible');
            }
        }

        function updateProgress(section) {
            const sectionOrder = ['auth', 'dashboard', 'class', 'student', 'attendance', 'analytics', 'recommend', 'report'];
            const index = sectionOrder.indexOf(section);
            const progress = ((index + 1) / sectionOrder.length) * 100;
            document.getElementById('progress-fill').style.width = progress + '%';
        }

        function resetView() {
            currentSection = null;
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.getElementById('floatingInfo').classList.remove('visible');
            document.getElementById('progress-fill').style.width = '0%';
            
            // Reset node styles
            setTimeout(() => {
                const mermaidSvg = document.querySelector('#mermaid-flowchart svg');
                if (mermaidSvg) {
                    const nodes = mermaidSvg.querySelectorAll('g.node');
                    nodes.forEach(node => {
                        node.style.filter = '';
                        node.style.transform = '';
                    });
                }
            }, 100);
        }

        // Search functionality
        function searchSections() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const buttons = document.querySelectorAll('.nav-btn[data-section]');
            
            buttons.forEach(btn => {
                const section = btn.dataset.section;
                const sectionInfo = sections[section];
                const isMatch = sectionInfo.title.toLowerCase().includes(searchTerm) || 
                               sectionInfo.description.toLowerCase().includes(searchTerm);
                
                if (searchTerm === '' || isMatch) {
                    btn.style.display = 'block';
                    btn.style.opacity = '1';
                } else {
                    btn.style.opacity = '0.3';
                }
            });
        }

        // Zoom functionality
        function zoomIn() {
            currentZoom = Math.min(currentZoom + 0.2, 3);
            applyZoom();
        }

        function zoomOut() {
            currentZoom = Math.max(currentZoom - 0.2, 0.5);
            applyZoom();
        }

        function resetZoom() {
            currentZoom = 1;
            applyZoom();
        }

        function applyZoom() {
            const mermaidDiv = document.getElementById('mermaid-flowchart');
            mermaidDiv.style.transform = `scale(${currentZoom})`;
            mermaidDiv.style.transformOrigin = 'center center';
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            // Add smooth animations
            setTimeout(() => {
                document.body.style.opacity = '1';
                document.body.style.transition = 'opacity 0.5s ease';
            }, 100);
        });
    </script>
</body>
</html>