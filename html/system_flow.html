<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Attendance System Flowchart</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.9.1/dist/mermaid.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@500;600;700&family=Inter:wght@400;500&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            transition: background-color 0.3s, color 0.3s;
        }
        .dark body {
            background-color: #1e1e2e;
            color: #f3f4f6;
        }
        h1, h2, h3 {
            font-family: 'Poppins', sans-serif;
        }
        .mermaid-container {
            max-width: 100%;
            overflow: auto;
            padding: 1.5rem;
            border-radius: 1rem;
            background: linear-gradient(145deg, #ffffff, #e6e6e6);
            box-shadow: 8px 8px 16px #d1d1d1, -8px -8px 16px #ffffff;
            transition: background 0.3s, box-shadow 0.3s;
        }
        .dark .mermaid-container {
            background: linear-gradient(145deg, #2a2a3c, #242435);
            box-shadow: 8px 8px 16px #1b1b29, -8px -8px 16px #35354b;
        }
        .sidebar {
            transition: transform 0.3s ease-in-out;
        }
        .sidebar-hidden {
            transform: translateX(-100%);
        }
        .nav-item {
            transition: transform 0.2s, background-color 0.2s;
        }
        .nav-item:hover {
            background-color: #3b82f6;
            color: white;
            transform: translateX(5px);
        }
        .tooltip {
            position: relative;
        }
        .tooltip .tooltip-text {
            visibility: hidden;
            width: 140px;
            background-color: #1f2937;
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 8px;
            position: absolute;
            z-index: 10;
            top: -50%;
            left: 110%;
            opacity: 0;
            transition: opacity 0.3s;
        }
        .tooltip:hover .tooltip-text {
            visibility: visible;
            opacity: 1;
        }
        .mode-toggle {
            transition: transform 0.3s, background-color 0.3s;
        }
        .mode-toggle:hover {
            transform: scale(1.1);
        }
        .legend-toggle {
            cursor: pointer;
            transition: background-color 0.2s;
        }
        .legend-toggle:hover {
            background-color: #e5e7eb;
        }
        .dark .legend-toggle:hover {
            background-color: #4b5563;
        }
        .search-bar {
            transition: border-color 0.3s;
        }
        .search-bar:focus {
            border-color: #3b82f6;
            outline: none;
        }
    </style>
</head>
<body class="bg-gray empire-50 flex min-h-screen">
    <aside class="sidebar fixed top-0 left-0 h-full w-64 bg-white dark:bg-gray-900 shadow-2xl p-6 transform sidebar-hidden lg:transform-none z-20" role="navigation" aria-label="Sidebar navigation">
        <div class="flex items-center justify-between mb-6">
            <h2 class="text-lg font-semibold text-gray-900 dark:text-white">Navigation</h2>
            <button id="toggle-sidebar" class="lg:hidden text-gray-600 dark:text-gray-300" aria-label="Toggle sidebar">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                </svg>
            </button>
        </div>
        <input type="text" id="search-bar" class="search-bar w-full mb-4 px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-gray-100 dark:bg-gray-800 text-gray-900 dark:text-white placeholder-gray-500" placeholder="Search sections..." aria-label="Search flowchart sections">
        <nav class="space-y-2">
            <button onclick="scrollToSection('all')" class="nav-item flex items-center w-full text-left px-4 py-2 rounded-lg text-gray-700 dark:text-gray-200 tooltip" data-tooltip="Show full flowchart" aria-label="Show all sections">
                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"></path></svg>
                <span class="tooltip-text">Show all sections</span>All
            </button>
            <button onclick="scrollToSection('auth')" class="nav-item flex items-center w-full text-left px-4 py-2 rounded-lg text-gray-700 dark:text-gray-200 tooltip" data-tooltip="Authentication pages" aria-label="Authentication section">
                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1"></path></svg>
                <span class="tooltip-text">Sign-Up/Login</span>Auth
            </button>
            <button onclick="scrollToSection('dashboard')" class="nav-item flex items-center w-full text-left px-4 py-2 rounded-lg text-gray-700 dark:text-gray-200 tooltip" data-tooltip="Main dashboard" aria-label="Dashboard section">
                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path></svg>
                <span class="tooltip-text">Teacher Dashboard</span>Dashboard
            </button>
            <button onclick="scrollToSection('class')" class="nav-item flex items-center w-full text-left px-4 py-2 rounded-lg text-gray-700 dark:text-gray-200 tooltip" data-tooltip="Manage classes" aria-label="Class Management section">
                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 14v3m4-3v3m4-3v3M3 21h18M3 10h18M3 7l9-4 9 4M4 10h16v11H4V10z"></path></svg>
                <span class="tooltip-text">Class Management</span>Classes
            </button>
            <button onclick="scrollToSection('student')" class="nav-item flex items-center w-full text-left px-4 py-2 rounded-lg text-gray-700 dark:text-gray-200 tooltip" data-tooltip="Manage students" aria-label="Student Management section">
                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"></path></svg>
                <span class="tooltip-text">Student Management</span>Students
            </button>
            <button onclick="scrollToSection('attendance')" class="nav-item flex items-center w-full text-left px-4 py-2 rounded-lg text-gray-700 dark:text-gray-200 tooltip" data-tooltip="Track attendance" aria-label="Attendance Tracking section">
                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"></path></svg>
                <span class="tooltip-text">Attendance Tracking</span>Attendance
            </button>
            <button onclick="scrollToSection('analytics')" class="nav-item flex items-center w-full text-left px-4 py-2 rounded-lg text-gray-700 dark:text-gray-200 tooltip" data-tooltip="View analytics" aria-label="Analytics section">
                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path></svg>
                <span class="tooltip-text">Analytics Dashboard</span>Analytics
            </button>
            <button onclick="scrollToSection('recommend')" class="nav-item flex items-center w-full text-left px-4 py-2 rounded-lg text-gray-700 dark:text-gray-200 tooltip" data-tooltip="View recommendations" aria-label="Recommendations section">
                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z"></path></svg>
                <span class="tooltip-text">Recommendations</span>Recommendations
            </button>
            <button onclick="scrollToSection('report')" class="nav-item flex items-center w-full text-left px-4 py-2 rounded-lg text-gray-700 dark:text-gray-200 tooltip" data-tooltip="Generate reports" aria-label="Report Generation section">
                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17v-2m3 2v-6m3 6v-8m-9 8h12a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg>
                <span class="tooltip-text">Report Generation</span>Reports
            </button>
        </nav>
    </aside>

    <main class="flex-grow container mx-auto px-4 py-8 lg:ml-64">
        <header class="flex items-center justify-between mb-6">
            <div>
                <h1 class="text-2xl md:text-3xl font-bold text-gray-900 dark:text-white">San Rafael National Trade School</h1>
                <p class="text-sm text-gray-600 dark:text-gray-400">Attendance Monitoring System Flowchart</p>
            </div>
            <div class="flex items-center space-x-4">
                <button id="download-svg" class="mode-toggle bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center" aria-label="Download flowchart as SVG">
                    <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="24 24 M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path></svg>
                    SVG
                </button>
                <button id="print-flowchart" class="mode-toggle bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 flex items-center" aria-label="Print flowchart">
                    <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"></path></svg>
                    Print
                </button>
                <button id="mode-toggle" class="mode-toggle bg-gray-200 dark:bg-gray-700 p-2 rounded-full" aria-label="Toggle dark/light mode">
                    <svg id="sun-icon" class="w-6 h-6 hidden dark:block text-yellow-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path>
                    </svg>
                    <svg id="moon-icon" class="w-6 h-6 block dark:hidden text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path>
                    </svg>
                </button>
                <button id="mobile-sidebar-toggle" class="lg:hidden text-gray-600 dark:text-gray-300" aria-label="Toggle sidebar">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                    </svg>
                </button>
            </div>
        </header>

        <div class="mermaid-container">
            <div id="mermaid-all" class="mermaid">
                graph TD
                    subgraph Authentication
                        A[Start] --> B[Sign-Up Page]
                        B -->|Register| C[Sign-In Page]
                        C -->|Login| D[Teacher Dashboard]
                        C -->|Logout| L[Settings/Logout]
                        L --> C
                    end
                    subgraph Dashboard
                        D -->|Manage Classes| E[Class Management Page]
                        D -->|Manage Students| F[Student Management Page]
                        D -->|Mark Attendance| G[Attendance Tracking Page]
                        D -->|View Analytics| H[Analytics Dashboard]
                        D -->|View Recommendations| J[Recommendation Interface]
                        D -->|Generate Reports| K[Report Generation Page]
                    end
                    subgraph Class Management
                        E --> E1[Class List]
                        E1 -->|Add New| E2[Add/Edit Class Form]
                        E2 -->|Save| E1
                        E1 -->|Edit/Delete| E
                        E --> D
                    end
                    subgraph Student Management
                        F --> F1[Student List]
                        F1 -->|Add New| F2[Add/Edit Student Form]
                        F1 -->|Import| F3[Upload Excel]
                        F2 -->|Save| F1
                        F3 -->|Validate & Save| F1
                        F1 -->|View| I[Student Dashboard]
                        F --> D
                    end
                    subgraph Attendance Tracking
                        G --> G1[Select Class/Date]
                        G1 --> G2[Attendance Grid]
                        G2 -->|Save| G3[Real-Time Alerts]
                        G3 --> D
                    end
                    subgraph Analytics
                        H --> H1[Apply Filters]
                        H1 --> H2[Charts & Statistics]
                        H2 -->|Export| H3[Download PNG/PDF]
                        H2 --> D
                    end
                    subgraph Recommendations
                        J --> J1[Filter Recommendations]
                        J1 --> J2[Recommendation List]
                        J2 -->|Acknowledge/Dismiss| J3[Archive Recommendations]
                        J2 -->|View| I
                        J3 --> D
                    end
                    subgraph Student Dashboard
                        I --> I1[View Attendance Data]
                        I1 -->|Export| I2[Download PDF/Excel]
                        I1 -->|Back| F
                        I --> D
                    end
                    subgraph Report Generation
                        K --> K1[Select Report Options]
                        K1 --> K2[Preview Report]
                        K2 -->|Generate & Download| K3[Download PDF/Excel]
                        K3 --> D
                    end
                    style Authentication fill:#bfdbfe,stroke:#3b82f6,stroke-width:2px,rx:8px,ry:8px
                    style Dashboard fill:#d1fae5,stroke:#10b981,stroke-width:2px,rx:8px,ry:8px
                    style Class Management fill:#d1fae5,stroke:#10b981,stroke-width:2px,rx:8px,ry:8px
                    style Student Management fill:#d1fae5,stroke:#10b981,stroke-width:2px,rx:8px,ry:8px
                    style Attendance Tracking fill:#d1fae5,stroke:#10b981,stroke-width:2px,rx:8px,ry:8px
                    style Analytics fill:#fef3c7,stroke:#f59e0b,stroke-width:2px,rx:8px,ry:8px
                    style Recommendations fill:#fef3c7,stroke:#f59e0b,stroke-width:2px,rx:8px,ry:8px
                    style Student Dashboard fill:#fef3c7,stroke:#f59e0b,stroke-width:2px,rx:8px,ry:8px
                    style Report Generation fill:#fef3c7,stroke:#f59e0b,stroke-width:2px,rx:8px,ry:8px
            </div>
            <div id="legend" class="mt-4 p-4 bg-gray-50 dark:bg-gray-800 rounded-lg">
                <div class="flex items-center justify-between">
                    <h3 class="text-sm font-medium text-gray-900 dark:text-white">Legend</h3>
                    <button id="toggle-legend" class="text-gray-600 dark:text-gray-300" aria-label="Toggle legend visibility">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                        </svg>
                    </button>
                </div>
                <div id="legend-content" class="mt-2 text-xs text-gray-600 dark:text-gray-300">
                    <label class="legend-toggle flex items-center px-2 py-1 rounded cursor-pointer">
                        <input type="checkbox" checked onchange="toggleSubgraph('Authentication')" aria-label="Toggle Authentication subgraph">
                        <span class="inline-block w-3 h-3 bg-blue-200 mr-2"></span>Authentication
                    </label>
                    <label class="legend-toggle flex items-center px-2 py-1 rounded cursor-pointer">
                        <input type="checkbox" checked onchange="toggleSubgraph('Dashboard')" aria-label="Toggle Dashboard subgraph">
                        <span class="inline-block w-3 h-3 bg-green-100 mr-2"></span>Dashboard & Core
                    </label>
                    <label class="legend-toggle flex items-center px-2 py-1 rounded cursor-pointer">
                        <input type="checkbox" checked onchange="toggleSubgraph('Analytics')" aria-label="Toggle Analytics subgraph">
                        <span class="inline-block w-3 h-3 bg-yellow-100 mr-2"></span>Analytics & Reports
                    </label>
                </div>
            </div>
        </div>
    </main>

    <footer class="bg-gradient-to-r from-blue-700 to-indigo-900 text-white py-6 mt-8">
        <div class="container mx-auto px-4 text-center text-sm">
            <p>© 2025 San Rafael National Trade School. All rights reserved.</p>
            <p class="mt-2">
                <a href="#" class="underline hover:text-gray-200">Privacy Policy</a> | 
                <a href="#" class="underline hover:text-gray-200">Contact Support</a>
            </p>
        </div>
    </footer>

    <script>
        // Initialize Mermaid
        mermaid.initialize({
            startOnLoad: true,
            theme: 'base',
            flowchart: { 
                curve: 'basis',
                nodeSpacing: 50,
                rankSpacing: 60
            },
            themeVariables: {
                primaryColor: '#3b82f6',
                secondaryColor: '#10b981',
                tertiaryColor: '#f59e0b',
                lineColor: '#4b5563',
                fontSize: '14px',
                fontFamily: 'Inter, sans-serif'
            }
        });

        // Dark/Light Mode Toggle
        const modeToggle = document.getElementById('mode-toggle');
        const sunIcon = document.getElementById('sun-icon');
        const moonIcon = document.getElementById('moon-icon');
        if (localStorage.getItem('theme') === 'dark') {
            document.body.classList.add('dark');
            sunIcon.classList.remove('hidden');
            moonIcon.classList.add('hidden');
        }
        modeToggle.addEventListener('click', () => {
            document.body.classList.toggle('dark');
            localStorage.setItem('theme', document.body.classList.contains('dark') ? 'dark' : 'light');
            sunIcon.classList.toggle('hidden');
            moonIcon.classList.toggle('hidden');
        });

        // Sidebar Toggle
        const sidebar = document.querySelector('.sidebar');
        const toggleSidebar = document.getElementById('toggle-sidebar');
        const mobileSidebarToggle = document.getElementById('mobile-sidebar-toggle');
        function toggleSidebarVisibility() {
            sidebar.classList.toggle('sidebar-hidden');
        }
        toggleSidebar.addEventListener('click', toggleSidebarVisibility);
        mobileSidebarToggle.addEventListener('click', toggleSidebarVisibility);

        // Scroll to Section
        function scrollToSection(section) {
            const mermaidDiv = document.getElementById('mermaid-all');
            mermaidDiv.scrollIntoView({ behavior: 'smooth' });
            const nodes = document.querySelectorAll(`g[id*="${section}"]`);
            nodes.forEach(node => {
                node.style.transition = 'stroke 0.3s';
                node.style.stroke = '#ff0000';
                setTimeout(() => node.style.stroke = '', 2000);
            });
        }

        // Search Bar Filtering
        const searchBar = document.getElementById('search-bar');
        searchBar.addEventListener('input', (e) => {
            const query = e.target.value.toLowerCase();
            const navItems = document.querySelectorAll('.nav-item');
            navItems.forEach(item => {
                const text = item.textContent.toLowerCase();
                item.style.display = text.includes(query) ? 'flex' : 'none';
            });
        });

        // Legend Toggle
        const toggleLegend = document.getElementById('toggle-legend');
        const legendContent = document.getElementById('legend-content');
        toggleLegend.addEventListener('click', () => {
            legendContent.classList.toggle('hidden');
            toggleLegend.querySelector('svg').classList.toggle('rotate-180');
        });

        // Subgraph Toggle (Simulated)
        function toggleSubgraph(subgraph) {
            const nodes = document.querySelectorAll(`g[id*="${subgraph}"]`);
            nodes.forEach(node => {
                node.style.display = node.style.display === 'none' ? '' : 'none';
            });
        }

        // Download SVG
        document.getElementById('download-svg').addEventListener('click', () => {
            const svg = document.querySelector('.mermaid svg');
            if (svg) {
                const serializer = new XMLSerializer();
                const source = serializer.serializeToString(svg);
                const blob = new Blob([source], { type: 'image/svg+xml;charset=utf-8' });
                const url = URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = url;
                link.download = 'attendance_system_flowchart.svg';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                URL.revokeObjectURL(url);
            } else {
                alert('Flowchart SVG not ready. Please wait for rendering to complete.');
            }
        });

        // Print Flowchart
        document.getElementById('print-flowchart').addEventListener('click', () => {
            window.print();
        });

        // Keyboard Navigation
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                sidebar.classList.add('sidebar-hidden');
            }
        });
    </script>
</body>
</html>